## Eclipse/Java/Papyrus插件使用与SysML预先研究

刘恒利（成都电子科技大学），田超（傲势科技）

### 引言

Eclipse是一个孵化IDE（集成开发环境）的插件平台系统，可以在Eclipse平台基础上通过扩展开发插件的方式形成用户定制的IDE。在Java诞生之初，Eclipse曾在相当长的一段时间，作为Java的主要开发平台。但Eclipse不仅仅是只用于Java的开发，在其之上开发的Python IDE（PyDev）还有C/C++ IDE（CDT）都是很不错的IDE。

SysML（系统建模语言）是UML（统一建模语言）的超集合，都是用来辅助现实世界抽象化的框图类标记工具。如果说UML是软件开发IT相关人员的“共同语言”，用于纯软件系统的设计与开发，那么SysML应该算是系统工程师的“共同语言”，用于生产制造环境中工业产品的需求、功能、逻辑、设计等环节。此类共同语言的存在，可以协调面向领域特定的开发人员，可以通过图表的方式，快速获得各方的设计理念，也极其方便了技术分工与协作。

SysML与UML有很多的相通之处，但也有其本身的特点。SysML中的图要素分为结构型图、行为型图、需求图三大类；而结构、行为、需求、参数是SysML的四大支柱。这四个支柱保证了SysML在描述工业产品时的完备性。详细可参考此[链接](http://www.omgsysml.org/what-is-sysml.htm) 。

Papyrus就是Eclipse这一IDE孵化器孵化出来的专门用于SysML建模的专用工具，当然Papyrus可以但不限于用于SysML建模，也可以用于UML的建模，但仅仅完成SysML的建模只是这一工具的一方面的功能，最为重要的功能是其中的模型执行器（Model Enabler）。

AOSSCI公司发起的Java-Eclipse-Papyrus项目，旨在完成SysML在Papyrus的完整应用流程，包括SysML各类图的建立与关联，行为图的有效化与模型的执行运行，定制的模型行为如何嵌入Papyrus环境等。



### SysML图

#### 概述各类类图

##### 模型与图形：

SysML消除了不同模型语言在表达法及术语上的不同，规范了符号和语义。从不同的描述角度区分定义了四种模型表示：结构模型强调系统的层次以及对象之间的相互连接关系，包括类和装配；行为模型强调系统中对象的行为，包括它们的活动、交互和状态历史；需求模型强调需求之间的追溯关系以及设计对需求的满足关系；参数模型强调系统或部件的属性之间的约束关系。

四种基本模型分别对应产生结构图(Structure Diagram)、参数图(Parametric Diagram)、需求图(Requirement Diagram)和行为图(Behavior Diagram) 。

SysML 的图形表示是SysML 的可视化表示，定义了九种基本图形来表示模型的各个方面：结构图用于显示系统中类或者部件的静态模型或者其之间的联系，包括类图(Class Diagram) 和装配图(Assembly Diagram)；参数图用于描述系统属性与属性之间的关系；需求图用于描述需求之间以及需求与其他建模元素的联系；行为图用于描述系统的动态模型和组成对象间的交互关系，包括活动图(Activity Diagram)、顺序图(Sequence Diagram)、时间图(Timing Diagram)、状态机图(State Machine Diagram)和用例图(Use Case Diagram)。

图形分类表示如下：

![SysML图结构](D:\Documents\Desktop\Java-Eclipse-Papyrus-master\SysML图结构.png)

##### 结构图：

结构图包括模块定义图和内部模块定义图以及包图，模块是SysML的基本结构单元，用来描述硬件、软件、设备人员以及其他系统元素。

模块定义图定义了模块的属性以及模块之间的相互关系，这类关系包括关联、泛化和依赖。模块定义图是基于UML类和复合结构拓展而来的，可以描述系统的结构特征。模块定义图有唯一的名字，封装了若干属性和操作，操作的每个参数都有名称和类型。

内部模块定义图用属性和连接定义了一个模块的内部结构，描述了部件之间的交互。内部模块定义图是在UML的复合结构图的基础之上进行了约束和拓展得到的。

包图描述了将模型元素组成组的机制，包图用于组织模型。

##### 参数图：

参数图是一种新的SysML图形，定义了一组系统属性以及属性之间的参数关系，参数关系说明了一个属性值变化怎样影响其他的属性值，参数关系是没有方向的。

参数模型是分析模型，把行为模型和结构模型与工程分析模型如性能模型和可靠性模型等结合在一起，能用来支持权衡分析，评价各种备选的方案。

参数约束是一个装配，用paramConstraint表示，通常和SysML装配图结合起来使用，paramConstraint声明一个装配用作参数约束，它的端口定义了参数约束的参数，其装配的唯一有效用法是用值绑定约束的绑定参数和装配中的其他属性。参数约束内部可以包含其他参数约束，但不能包含其他部件或属性。参数约束关系用来表示系统的结构模型中属性之间的依赖关系，可以使基本的数学操作符也可以是物理相关的数学表达式。

##### 需求图：

需求图是一种新的SysML图形，能够描述需求和需求之间以及需求与其他建模元素之间的关系。需求指系统必须满足的能力或条件，一个需求能够分解成多个子需求。需求也是一个类，具有text和id两个属性，前者是需求的文本描述，后者是需求的标识符，用户可以定义需求的子类，如操作需求、功能需求、接口需求、性能需求等等。

使用导出关系derive表示一个需求可以从另外一个需求产生；使用满足关系satisfy表示一个需求能被其他的模型元素实现；使用验证关系verify表示一个需求能被测试子验证；以上SysML四种关系都是继承UML的trace，SysML用rationale表示基本原理注释元素，能够附在任何模型元素上，用来说明建模决策如分析决策或设计决策的原理或原因。

##### 行为图：

用例图提供了一种系统之间以及系统内部之间较高层次的功能性描述，描述了外部参与者对系统的使用，这是通过系统向参与者提供一系列服务来实现的。用例图包括用例、参与者以及它们之间的通讯，参与者可能是用户、外部系统或其他环境实体，它们和系统直接或间接交互。用例和用户之间的关系包括包含include、扩展extend和泛化generalization关系，SysML用例图重用了UML用例图。

活动图描述活动之间的数据流和控制流，强调活动的输入输出、顺序和条件。SysML活动图对UML活动图进行了扩展，包括把控制作为数据、表示连续的物质或能量流、引入概念等，控制既能使动作开始也能使正在执行的动作终止。

顺序图描述了系统中相互协作的部件之间的交互，根据控制流制订了一连串的交互，控制流是通过对象生命线之间发送和接受消息来定义的。消息包含了控和数据流，它发起接受消息的对象的行为，并把输入传给行为，消息的时间顺序和它在顺序图上的垂直位置相关。复杂的顺序可以抽象成引用顺序图。顺序图上可以包含条件逻辑，表示选择、连续流和循环等。对象生命线可以进一步分解为它的组成部分，SysML顺序图重用了UML顺序图。

状态机图描述了系统或者其部件在完成事件响应时的状态转换或行为，通过状态以及状态之间的转移对离散行为建模，它把行为表示为对象的状态历史。在状态的转移、进入和退出过程中会调用活动，并指定相关的事件和守卫条件。一个组和条件有嵌套的状态，可以是顺序的也可以是并发的，SysML状态机图重用了UML状态机图。



#### 举例一个完整例子串联各种类图



### 模型有效化与执行

#### SysML模型在Papyrus中的执行机理

#### SysML建模流程

#### SysML的执行流程



### 定制模型行为与外部Java代码嵌入

#### 定制模型行为机理

#### Java代码的执行举例 



### 参考

1. Papyrus的举例参见[链接](https://github.com/webgme/sysml/tree/master/examples/Papyrus)。这之中的链接应该非常直观，对研究Papyrus很有帮助。
2. OMG官方的SysML教程参见[链接](http://www.omgsysml.org/INCOSE-OMGSysML-Tutorial-Final-090901.pdf)。
3. 参考[举例](https://www.modeliosoft.com/en/resources/sysml-example.html) 。
4. SysML有一OMG官方链接[参见](http://www.omg.org/ocsmp/HSUV.pdf)。

